# Changelog

## [2024-12-19] - Исправление бесконечных ререндеров и проблем с загрузкой

### Исправлено

- Устранены бесконечные ререндеры в компонентах с вакансиями
- Убраны все `console.log` из компонентов и хуков, которые вызывали проблемы с ререндером
- Оптимизированы зависимости в хуке `useFilter` для предотвращения лишних пересчетов
- Оптимизирован хук `useGetCatalog` с добавлением `useMemo` для параметров
- Исправлены проблемы с загрузкой профиля и быстрых фильтров
- Исправлены циклические зависимости в хуках `useFilter` и `useGetCatalog`
- Исправлена проблема с дублирующимися ключами в `CardVacancy` для `ChipUI`
- Исправлена логика в хуке `useBreadcrumb` для предотвращения зацикливания
- Исправлены проблемы с зацикливанием на мобильных устройствах и бесконечным показом скелетона
- Убраны `console.log` из компонентов главной страницы: `HREcosystemSection`, `Team`
- Убран `console.log` из хука `useGetHome`

### Файлы

- `src/features/vacancy/search/model/use-filter.tsx`
- `src/entity/vacancy/api/get-catalog/index.ts`
- `src/shared/hooks/use-query-param-action/index.ts`
- `src/shared/hooks/use-breadcrumb/index.tsx`
- `src/features/vacancy/search/ui/index.tsx`
- `src/features/vacancy/search/ui/quick-filters.tsx`
- `src/shared/ui/select-ui/index.tsx`
- `src/entity/vacancy/ui/card-vacancy.tsx`
- `src/widgets/mainblocks/hr-ecosystem/index.tsx`
- `src/widgets/mainblocks/team/index.tsx`
- `src/entity/user/api/get-home/index.ts`

## [2024-12-19] - Исправление дублирующихся ключей в компонентах с вакансиями

### Исправлено

- Устранена ошибка "Encountered two children with the same key" в компонентах, работающих с вакансиями
- Исправлены дублирующиеся ключи в `ListVacancies` - заменен ключ на составной из индекса, ID, названия и города вакансии
- Исправлены дублирующиеся ключи в `QuickFilters` - заменен ключ на `filter.slug` вместо `filter.name + index`
- Исправлены дублирующиеся ключи в `AboutVacancy` для всех map-функций
- Исправлены дублирующиеся ключи в `SelectUI` для элементов выбранных значений

### Файлы

- `src/entity/vacancy/ui/list-vacancies.tsx`
- `src/features/vacancy/search/ui/quick-filters.tsx`
- `src/widgets/vacancy/about-vacancy/index.tsx`
- `src/shared/ui/select-ui/index.tsx`

## [2024-12-19] - Добавление React Select компонента

### Добавлено

- Новый компонент `SelectUI_RS` на базе библиотеки react-select
- Совместимый API с существующим `SelectUI` компонентом
- Кастомные стили для react-select в виде объекта `reactSelectStyles`
- Отдельный файл стилей `react-select-styles.ts` для лучшей организации кода
- Индексный файл для удобного импорта нового компонента

### Файлы

- `src/shared/ui/select-ui/react-select.tsx`
- `src/shared/ui/select-ui/react-select-styles.ts`
- `src/shared/ui/select-ui/react-select-index.tsx`

## [2024-12-19] - Исправление перекрытия дубликатов в HR экосистеме

### Исправлено

- Проблема перекрытия дубликатов другими карточками во внешнем круге HR экосистемы
- Изменен порядок рендеринга: сначала все оригинальные элементы, затем все дубликаты
- Добавлены уникальные ключи для оригинальных и дублированных элементов
- Настроен правильный z-index для предотвращения перекрытия

## [2024-12-19] - Модификация HR экосистемы и добавление свечения к World Icon

### Добавлено

- Свечение для кружков в World Icon UI с использованием SVG фильтров
- Непрерывный поток элементов в HR экосистеме через дублирование

### Изменено

- Скорость анимации вращения в HR экосистеме снижена в 2 раза (с 30s до 60s)
- Элементы HR экосистемы теперь дублируются для создания эффекта непрерывного потока
- Дубликаты элементов размещаются с смещением на 180 градусов для равномерного распределения

### Исправлено

- Начальная невидимость кружков в World Icon до начала анимации
- Визуальная "пустота" в HR пространстве через постоянное присутствие всех элементов

## [2024-12-18] - Инициализация проекта

### Добавлено

- Базовая структура проекта TopFrame
- Основные компоненты и страницы
- Система маршрутизации
- API интеграция
- Стилизация и анимации

## [2025-08-19] - Мобильное меню: бургер на span-полосках

### Изменено

- Псевдоэлементы `:before`/`:after` у `label.mobile-menu__label` заменены на три `span`-полоски для лучшей управляемости и предсказуемости анимаций.
- Сохранены размеры и поведение иконки; анимация перехода в «крестик» реализована через трансформации верхней и нижней полосок, средняя скрывается.

### Файлы

- `src/widgets/mainblocks/header/ui/mobile-menu/index.tsx`
- `styles/components/mobile-menu.scss`

## [2025-08-18] - Мобильное меню: фикc лагов и пикселизации на Android

### Изменено

- Переведена анимация раскрытия с `width/height/top/right` на `clip-path: circle()` для плавного, аппаратно-ускоренного раскрытия без пикселизации краёв.
- Ускорено появление пунктов меню: снижены задержки анимации для `.mobile-menu__item`.

### Файлы

- `styles/components/mobile-menu.scss`

## [2025-08-08] - Фикс поведения видео на мобильных и стоп по клику вне

### Добавлено

- Остановка видео при клике вне контейнера видео

### Изменено

- Разведено поведение для устройств с hover (desktop) и touch (mobile):
  - Desktop: запуск по `pointerenter`, пауза по `pointerleave`
  - Mobile: запуск по тапу по контейнеру; `pointerleave` больше не используется
- Стабилизированы обработчики событий для корректного снятия `eventListener`

### Исправлено

- На мобильных устройствах `pointerleave` больше не срабатывает сразу после тапа по видео
- Убран глобальный `document.click` для размьюта, чтобы избежать неожиданных побочных эффектов
- Корректно снимаются слушатели при размонтировании компонента

## [2025-08-08] - Скелетон страницы подробного описания направления

### Добавлено

- Скелетон `HrEcosystemArticleSkeleton` для страницы с подробным описанием статьи о направлении
- Использован `react-loading-skeleton`; покрыты заголовок, абзацы, блок преимуществ, блок шагов, кнопка и боковое изображение

### Файлы

- `src/widgets/mainblocks/hr-ecosystem-article/skeleton.tsx`

## [2025-08-08] - Контакты: новые маршруты и хуки

### Добавлено

- В `home-module.ts` добавлены маршруты:
  - `GET /api/contact` — список email, телефонов и документов
  - `GET /api/contact/{slug}` — получение документа по slug
- Новые схемы: `ContactItemDto`, `ContactDocumentDto`
- Хуки:
  - `useGetContacts` (+ `getContactsOptions`)
  - `useGetContactDetail` (+ `getContactDetailOptions`)

### Файлы

- `src/shared/api/schema/components.ts`
- `src/shared/api/schema/modules/home-module.ts`
- `src/entity/user/api/get-contacts/index.ts`
- `src/entity/user/api/get-contacts/options.ts`
- `src/entity/user/api/get-contact-detail/index.ts`
- `src/entity/user/api/get-contact-detail/options.ts`

## [2024-01-15] - Добавление плавных переходов для видео в секции команды

### Добавлено

- Плавные переходы между постером и видео (0.5s ease-in-out)
- Отдельный элемент постера для лучшего контроля анимации
- Градиентные состояния загрузки видео (прозрачность 0.8 при готовности)
- Анимация кнопки воспроизведения с hover эффектом
- Улучшенная визуальная обратная связь при загрузке

### Изменено

- Структура компонента: постер теперь отдельный div элемент
- CSS переходы увеличены до 0.5s для более плавной анимации
- Логика показа видео: opacity 0.8 при загрузке, 1.0 при воспроизведении
- Улучшены z-index значения для корректного наложения элементов
- Обновлены данные команды с более разнообразными видео

### Исправлено

- Убран неработающий CSS attr(data-poster)
- Исправлена логика класса video-loaded (!isLoading вместо isLoading)
- Улучшена плавность переходов между состояниями

## [2024-01-15] - Исправление воспроизведения видео в секции команды

### Добавлено

- Улучшенная обработка состояний загрузки видео
- Поддержка различных событий загрузки видео (onLoadStart, onCanPlay, onError)
- Индикатор загрузки видео с настраиваемыми параметрами
- Обработка ошибок с отображением сообщений пользователю
- Поддержка autoplay policy браузеров

### Изменено

- Переименовано состояние `isLoaded` в `isLoading` для более точного отражения логики
- Улучшена логика хука `useVideo` с использованием `useCallback`
- Обновлена логика показа компонентов (лоадер, кнопка воспроизведения)
- Добавлен атрибут `playsInline` для мобильных устройств
- Добавлен `preload="metadata"` для оптимизации загрузки

### Исправлено

- Исправлена проблема с неработающим воспроизведением видео при наведении
- Исправлена логика лоадера (показывался в неправильное время)
- Улучшена обработка ошибок загрузки видео
- Добавлена защита от множественных вызовов воспроизведения

### Техническая информация

- Файлы: `src/widgets/mainblocks/team/index.tsx`, `src/shared/lib/cls/video/use-video/index.tsx`
- Стили: `styles/pages/home.scss`
- Данные: видео файлы в `public/video/` (1.mp4, 2.mp4, 3.mp4)

## [2024-12-19] - Создание скелетонов для компонентов

### Добавлено

- Скелетон для профиля в шапке (`ButtonAuthSkeleton`)
- Скелетон для информации в профиле (`InfoUserSkeleton`)
- Скелетон для карточки вакансии (`CardVacancySkeleton`)
- Скелетон для быстрых фильтров (`QuickFiltersSkeleton`)
- Скелетон для страницы вакансии (`VacancyPageSkeleton`)

### Технические детали

- Использована библиотека `react-loading-skeleton`
- Все скелетоны созданы в отдельных файлах `skeleton.tsx` рядом с основными компонентами
- Скелетоны адаптированы под дизайн-систему проекта
- Добавлена документация в заголовки файлов

## [2024-12-19] - Рефакторинг компонента поиска вакансий

### Добавлено

- Компонент `SearchBox` для логики поиска вакансий
- Компонент `QuickFilters` для быстрых фильтров
- Компонент `FilterSidebar` для боковой панели фильтров
- Компонент `VacancyResults` для отображения результатов с пагинацией

### Изменено

- Рефакторинг основного компонента `SearchVacancies` для использования разделенных компонентов
- Улучшена модульность и переиспользуемость компонентов
- Соблюдение принципов FSD архитектуры

### Исправлено

- Исправлена типизация `rootRef` в компоненте `FilterSidebar`

## [2025-01-15] - Создание скелетонов для страниц направления и HR

### Добавлено

- Скелетон для страницы направления (`SkeletonDirectionDetails`)
- Скелетон для HR страницы (`SkeletonHrTopFrameBlock`)
- Использование библиотеки `react-loading-skeleton` для создания скелетонов
- Адаптивные скелетоны с учетом структуры и стилей оригинальных компонентов

### Технические детали

- Скелетоны созданы в файлах `skeleton.tsx` рядом с основными компонентами
- Учтены размеры и пропорции оригинальных элементов (изображения, текста, кнопок)
- Добавлены комментарии для лучшего понимания структуры скелетонов
- Скелетоны поддерживают responsive дизайн

### Файлы

- `src/widgets/mainblocks/direction-details/skeleton.tsx`
- `src/widgets/mainblocks/hr-top-frame-block/skeleton.tsx`

## [2025-01-15] - Создание модуля главной страницы и хуков

### Добавлено

- Новый модуль `home-module.ts` для API главной страницы
- Хук `useGetHome` для получения данных главной страницы
- Хук `useGetSpace` для получения списка разделов SPACE
- Хук `useGetSpaceDetail` для получения детальной информации о разделе SPACE
- Новые схемы в components: `AboutUsDto`, `SpaceItemDto`, `VacancyPreviewDto`, `TeamMemberDto`
- Файлы options для всех новых хуков

### Технические детали

- Модуль поддерживает полную структуру данных главной страницы
- Хуки следуют паттерну FSD архитектуры
- Добавлена типизация для всех новых схем
- Хуки возвращают структурированные данные с деструктуризацией

### Файлы

- `src/shared/api/schema/modules/home-module.ts`
- `src/shared/api/schema/components.ts` (обновлен)
- `src/shared/api/schema/index.ts` (обновлен)
- `src/entity/user/api/get-home/index.ts`
- `src/entity/user/api/get-home/options.ts`
- `src/entity/user/api/get-space/index.ts`
- `src/entity/user/api/get-space/options.ts`
- `src/entity/user/api/get-space-detail/index.ts`
- `src/entity/user/api/get-space-detail/options.ts`

## [2025-01-15] - Интеграция хуков в компоненты главной страницы

### Добавлено

- Скелетоны для всех компонентов главной страницы с использованием `react-loading-skeleton`
- Интеграция хука `useGetHome` в компоненты: `ZeroHero`, `Directions`, `Team`, `NewVacancies`
- Интеграция хука `useGetSpace` в компонент `HREcosystemSection`
- Новый компонент `NewVacancies` для отображения вакансий с API
- Обновление компонента `MainInfo` для принятия данных `aboutUs`

### Изменено

- Компоненты теперь используют данные из API вместо статических данных
- Добавлена обработка состояний загрузки с отображением скелетонов
- Обновлена типизация для работы с API данными
- Компонент `Team` теперь использует `ourTeam` данные из API

### Технические детали

- Все скелетоны созданы в отдельных файлах `skeleton.tsx`
- Скелетоны адаптированы под структуру и стили оригинальных компонентов
- Добавлена проверка на существование данных перед рендерингом
- Компоненты показывают скелетоны во время загрузки данных

### Файлы

- `src/widgets/mainblocks/zero-hero/index.tsx` (обновлен)
- `src/widgets/mainblocks/zero-hero/skeleton.tsx` (создан)
- `src/widgets/mainblocks/zero-hero/ui/main-info/index.tsx` (обновлен)
- `src/widgets/mainblocks/hr-ecosystem/index.tsx` (обновлен)
- `src/widgets/mainblocks/hr-ecosystem/skeleton.tsx` (создан)
- `src/widgets/mainblocks/directions/index.tsx` (обновлен)
- `src/widgets/mainblocks/directions/skeleton.tsx` (создан)
- `src/widgets/mainblocks/team/index.tsx` (обновлен)
- `src/widgets/mainblocks/team/skeleton.tsx` (создан)
- `src/widgets/mainblocks/new-vacancies/index.tsx` (создан)
- `src/widgets/mainblocks/new-vacancies/skeleton.tsx` (создан)
- `src/app/page.tsx` (обновлен)
